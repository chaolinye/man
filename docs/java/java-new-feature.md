# Java 新特性

## JShell: 快速验证简单的小问题

JDK9 正式发布

JShell提供了一种在 JShell 状态下交互式评估 Java 编程语言的声明、语句和表达式的方法。JShell 的状态包括不断发展的代码和执行状态。为了便于快速调查和编码，语句和表达式不需要出现在方法中，变量和方法也不需要出现在类中。

JShell的设计并不是为了取代IDE。JShell在处理简单的小逻辑，验证简单的小问题时，比IDE更有效率。如果我们能够在有限的几行代码中，把要验证的问题表达清楚，JShell就能够快速地给出计算的结果。这一点，能够极大地提高我们的工作效率和学习热情。

使用方式：

```bash
# 启动，-v 详细信息模式
jshell -v

# Hello world
System.out.prontln("Hello JShell")

# 退出
/exit
```

## 文字块: 编写所见即所得的字符串

在JDK 13中以预览版的形式发布，在JDK 15正式发布。

```java
// 老方式
String stringBlock =
        "<!DOCTYPE html>\n" +
        "<html>\n" +
        "    <body>\n" +
        "        <h1>\"Hello World!\"</h1>\n" +
        "    </body>\n" +
        "</html>\n";

// 新方式
String textBlock = """
        <!DOCTYPE html>
        <html>
            <body>
                <h1>"Hello World!"</h1>
            </body>
        </html>
        """;
```

 文字块由零个或多个内容字符组成，从开始分隔符开始，到结束分隔符结束。开始分隔符是由三个双引号字符 (""") ，后面跟着的零个或多个空格，以及行结束符组成的序列。结束分隔符是一个由三个双引号字符 (""")组成的序列。

需要注意的是，开始分隔符必须单独成行；三个双引号字符后面的空格和换行符都属于开始分隔符。结束分隔符只有一个由三个双引号字符组成的序列。结束分隔符之前的字符，包括换行符，都属于文字块的有效内容。

不同于传统字符串的是，在编译期，文字块要顺序通过如下三个不同的编译步骤：

1. 为了降低不同平台间换行符的表达差异，编译器把文字内容里的换行符统一转换成 LF（\u000A）；
2. 为了能够处理Java源代码里的缩进空格，要删除所有文字内容行和结束分隔符共享的前导空格，以及所有文字内容行的尾部空格；
3. 最后处理转义字符，这样开发人员编写的转义序列就不会在第一步和第二步被修改或删除。

## 档案类：精简地表达不可变数据

## 封闭类：刹住失控的扩展性

## 类型匹配：切除臃肿的强制转换

## switch表达式: 简化多情景操作

## switch匹配: 适配不同的类型

## 基于switch模式匹配和封闭类优化错误码的异常处理方式

## Flow 反应式编程

## 空指针处理优化

## 模型系统

## References

- [深入剖析Java新特性](https://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90Java%E6%96%B0%E7%89%B9%E6%80%A7)
